(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    111703,       2373]
NotebookOptionsPosition[    109918,       2337]
NotebookOutlinePosition[    110315,       2353]
CellTagsIndexPosition[    110272,       2350]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization Cells. (scroll down to run simulation)", "Item",
 CellChangeTimes->{{3.8862642737052383`*^9, 3.886264331036066*^9}},
 FontSize->36,ExpressionUUID->"3d534153-7ecd-45e7-b627-6e865fe32bc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</../\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "SimulationRewardDriven4`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"displays", " ", "results", " ", "of", " ", "simulation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotBelief1", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plot", ",", "plotforrange1", ",", "plotforrange2", ",", "data", ",", 
       "size"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "/@", 
          RowBox[{"BELIEF", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Length", "/@", "data"}], ")"}], "//", "Max"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", "nquestionsUSER"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"data", "//", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{"#", ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<j\>\"", ",", "Large"}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<d\>\"", ",", "Large"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<a= \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"AffinityValues", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
                 "\"\<, b=\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"BiasValues", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", "Large"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"AffinityValues", "//", "Length"}]}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"TicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"\"\<Label\>\"", ",", " ", "20"}], "]"}]}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotforrange1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "dMAX"}], "-", "0.5"}], ",", 
              RowBox[{"size", "-", "1"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"dMAX", "+", "0.5"}], ",", "1"}], "]"}]}], "]"}], "}"}],
          ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"TicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"\"\<Label\>\"", ",", " ", "20"}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "->", "None"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<size=\>\"", ",", "size"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"plotforrange1", ",", "plot"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"markerphase", "[", 
   RowBox[{
    RowBox[{"in_", ":", 
     RowBox[{"GrayLevel", "[", "0", "]"}]}], ",", 
    RowBox[{"out_", ":", 
     RowBox[{"GrayLevel", "[", "0", "]"}]}], ",", 
    RowBox[{"size_", ":", "7"}]}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{"EdgeForm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", "out"}], "}"}], 
       "]"}], ",", 
      RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "size"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"marker", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DMAX", "=", "dMAX"}], ",", 
       RowBox[{"DMIN", "=", 
        RowBox[{"-", "dMAX"}]}], ",", 
       RowBox[{"opacity", "=", "0.08"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"d", "//", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "DMAX"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"opacity", ",", 
             RowBox[{"ColorData", "[", 
              RowBox[{"\"\<VisibleSpectrum\>\"", ",", "470"}], "]"}]}], "]"}],
            ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "470"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"#", "\[Equal]", "DMIN"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"opacity", ",", 
             RowBox[{"ColorData", "[", 
              RowBox[{"\"\<VisibleSpectrum\>\"", ",", "630"}], "]"}]}], "]"}],
            ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "630"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DMAX", ">", "#", ">", "0"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "470"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DMIN", "<", "#", "<", "0"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "630"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"opacity", ",", "Black"}], "]"}], ",", "Black", ",", 
           "10"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"#", "===", "666"}], ",", "\[InvisibleSpace]", 
         "\"\<\[InvisibleSpace]\>\"", ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[CheckedBox]\>\"", ",", 
           InterpretationBox[
            ButtonBox[
             TooltipBox[
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[1, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               DefaultBaseStyle->"ColorSwatchGraphics",
               Frame->True,
               
               FrameStyle->RGBColor[
                0.6666666666666666, 0., 0.6666666666666666],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None],
              StyleBox[
               RowBox[{"RGBColor", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
               False]],
             Appearance->None,
             BaseStyle->{},
             BaselinePosition->Baseline,
             ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
               If[
                Not[
                 AbsoluteCurrentValue["Deployed"]], 
                SelectionMove[Typeset`box$, All, Expression]; 
                FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                FrontEnd`Private`$ColorSelectorInitialColor = 
                 RGBColor[1, 0, 1]; 
                FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                MathLink`CallFrontEnd[
                  FrontEnd`AttachCell[Typeset`box$, 
                   FrontEndResource["RGBColorValueSelector"], {
                   0, {Left, Bottom}}, {Left, Top}, 
                   "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
             DefaultBaseStyle->{},
             Evaluator->Automatic,
             Method->"Preemptive"],
            RGBColor[1, 0, 1],
            Editable->False,
            Selectable->False], ",", "Large"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"marker2", "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "reachedstopcond_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DMAX", "=", "dMAX"}], ",", 
       RowBox[{"DMIN", "=", 
        RowBox[{"-", "dMAX"}]}], ",", 
       RowBox[{"opacity", "=", "0.1"}], ",", 
       RowBox[{"opacityline", "=", "0.3"}], ",", "\[IndentingNewLine]", 
       RowBox[{"sizemin", "=", "4"}], ",", 
       RowBox[{"sizeinc", "=", "8"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"red", "=", "640"}], ";", "\[IndentingNewLine]", 
      RowBox[{"purple", "=", "450"}], ";", "\[IndentingNewLine]", 
      RowBox[{"darkblue", "=", "475"}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "//", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"reachedstopcond", ",", "\[IndentingNewLine]", 
          RowBox[{"#", "//", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DMAX", "\[GreaterEqual]", " ", "#", ">", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacity", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "darkblue"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{"ColorData", "[", 
                  RowBox[{"\"\<VisibleSpectrum\>\"", ",", "480"}], "]"}], 
                 "*)"}], "Transparent", ",", 
                RowBox[{"sizemin", "+", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DMIN", "\[LessEqual]", " ", "#", "<", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacity", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "red"}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{"ColorData", "[", 
                  RowBox[{"\"\<VisibleSpectrum\>\"", ",", "625"}], "]"}], 
                 "*)"}], "Transparent", ",", 
                RowBox[{"sizemin", "+", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "\[Equal]", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacity", ",", "Transparent"}], "]"}], ",", "Black",
                 ",", 
                RowBox[{"2", " ", "sizemin"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "===", "666"}], ",", "\[InvisibleSpace]", 
              "\"\<\[InvisibleSpace]\>\"", ",", "\[IndentingNewLine]", "True",
               ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\[CheckedBox]\>\"", ",", 
                InterpretationBox[
                 ButtonBox[
                  TooltipBox[
                   GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {RGBColor[1, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    DefaultBaseStyle->"ColorSwatchGraphics",
                    Frame->True,
                    
                    FrameStyle->RGBColor[
                    0.6666666666666666, 0., 0.6666666666666666],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                   StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
                    False]],
                  Appearance->None,
                  BaseStyle->{},
                  BaselinePosition->Baseline,
                  ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                  DefaultBaseStyle->{},
                  Evaluator->Automatic,
                  Method->"Preemptive"],
                 RGBColor[1, 0, 1],
                 Editable->False,
                 Selectable->False], ",", "Large"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "&"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"#", "//", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DMAX", "\[GreaterEqual]", " ", "#", ">", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacityline", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "darkblue"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"sizemin", "+", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DMIN", "\[LessEqual]", " ", "#", "<", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacityline", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "red"}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"sizemin", "+", " ", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "\[Equal]", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Opacity", "[", 
                 RowBox[{"1.0", ",", "Black"}], "]"}], ",", 
                RowBox[{"2", " ", "sizemin"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "===", "666"}], ",", "\[InvisibleSpace]", 
              "\"\<\[InvisibleSpace]\>\"", ",", "\[IndentingNewLine]", "True",
               ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\[CheckedBox]\>\"", ",", 
                InterpretationBox[
                 ButtonBox[
                  TooltipBox[
                   GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {RGBColor[1, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    DefaultBaseStyle->"ColorSwatchGraphics",
                    Frame->True,
                    
                    FrameStyle->RGBColor[
                    0.6666666666666666, 0., 0.6666666666666666],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                   StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
                    False]],
                  Appearance->None,
                  BaseStyle->{},
                  BaselinePosition->Baseline,
                  ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                  DefaultBaseStyle->{},
                  Evaluator->Automatic,
                  Method->"Preemptive"],
                 RGBColor[1, 0, 1],
                 Editable->False,
                 Selectable->False], ",", "Large"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "&"}]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], "&"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhasePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"biasaffpair_", ",", "BeliefFinal_"}], "}"}], ",", "label_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "meanconclusion", ",", "markertable", ",", "invisible", ",", "range", 
       ",", "biasaffpairPADDED", ",", "meanconclusionPADDED"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"meanconclusion", "=", 
       RowBox[{"Mean", "/@", "BeliefFinal"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meanconclusionPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"666", ",", "666"}], "}"}], ",", "meanconclusion"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"markertable", "=", 
       RowBox[{"marker", "/@", 
        RowBox[{"(", "meanconclusionPADDED", ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"invisible", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bMIN", ",", "aMIN"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bMAX", ",", "aMAX"}], "}"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"aMIN", ",", "aMAX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"bMIN", ",", "bMAX"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"biasaffpairPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"invisible", ",", 
         RowBox[{"List", "/@", "biasaffpair"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<plot range: \>\"", ",", "invisible"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "biasaffpairPADDED"}],
         ")"}], "//", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "markertable"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Bold", ",", " ", "16"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<a\>\"", ",", "Bold", ",", "Large"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<b\>\"", ",", "Bold", ",", "Large"}], "]"}]}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "label"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.9"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageMargins", "\[Rule]", "25"}]}], "]"}], "&"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhasePlot2", "[", 
    RowBox[{"BELIEF_List", ",", "PHASE_List", ",", "label_", ",", 
     RowBox[{"message_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reachedstopcond", ",", "meanconclusion", ",", "meanconclusionstop", 
       ",", "markertable", ",", "invisible", ",", "range", ",", "range2", ",", 
       RowBox[{"biasaffpair", "=", 
        RowBox[{"PHASE", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "biasaffpairPADDED", ",", 
       "meanconclusionstopPADDED", ",", "plot1", ",", "plot2", ",", "amin", 
       ",", "amax", ",", "bmin", ",", "bmax", ",", "fontsize", ",", 
       "fontcolor"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"message", "//", "TrueQ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<WARNING: \>\"", ",", "Bold", ",", "Orange", ",", "Medium"}], 
           "]"}], ",", "\"\< Using nquestions=\>\"", ",", "nquestions", ",", 
          "\"\< to verify stop condition.\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reachedstopcond", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "<", "nquestions"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Length", "/@", "BELIEF"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meanconclusion", "=", 
       RowBox[{"Mean", "/@", 
        RowBox[{"BELIEF", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meanconclusionstop", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"meanconclusion", ",", "reachedstopcond"}], "}"}], "//", 
        "Transpose"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"meanconclusionstopPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"666", ",", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"666", ",", "True"}], "}"}]}], "}"}], ",", 
         "meanconclusionstop"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"markertable", "=", 
       RowBox[{"marker2", "/@", 
        RowBox[{"(", "meanconclusionstopPADDED", ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "markertable", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"amin", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}], "//", "Min"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"amax", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}], "//", "Max"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"bmin", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"bmax", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"extend", " ", "ranges", " ", "a", " ", "bit"}], ",", " ", 
        RowBox[{"for", " ", "visibility"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"amin", "=", 
       RowBox[{"amin", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"amax", "-", "amin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"amax", "=", 
       RowBox[{"amax", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"amax", "-", "amin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmin", "=", 
       RowBox[{"bmin", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"bmax", "-", "bmin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmax", "=", 
       RowBox[{"bmax", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"bmax", "-", "bmin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"invisible", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bmin", ",", "amin"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bmax", ",", "amax"}], "}"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bmin", ",", "bmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"amin", ",", "amax"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range2", "=", 
       RowBox[{"range", "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"biasaffpairPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"invisible", ",", 
         RowBox[{"List", "/@", "biasaffpair"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"plot1", "=", 
         RowBox[{
          RowBox[{"(", "biasaffpairPADDED", ")"}], "//", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"PlotMarkers", "\[Rule]", "markertable"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Bold", ",", " ", "16"}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<b\>\"", ",", "Bold", ",", "Large"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<a\>\"", ",", "Bold", ",", "Large"}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "label"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "0.9"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageMargins", "\[Rule]", "25"}]}], "]"}], "&"}]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fontsize", "=", "28"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fontcolor", "=", "Black"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          "biasaffpairPADDED"}], ")"}], "//", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"#", ",", 
           RowBox[{"PlotMarkers", "\[Rule]", "markertable"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "range2"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "650"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", " ", 
             RowBox[{"fontcolor", ",", "fontsize"}], "]"}]}], ",", 
           RowBox[{"TicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"fontcolor", ",", "fontsize"}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(a\), \(0\)]\)\>\"", ",", "fontcolor",
                 ",", "fontsize"}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<b\>\"", ",", "fontcolor", ",", "fontsize"}], 
               "]"}]}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"label", ",", "fontsize"}], "]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.9"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"ImageMargins", "\[Rule]", "25"}]}], "]"}], "&"}]}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "plot2"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetPHASEq", "[", "qmax_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"snapshot", " ", "at", " ", "qmax"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"length", ",", "maxlength", ",", "lengtheff", ",", "PHASEq"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BELIEF", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "//", "Length"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxlength", "=", 
       RowBox[{"Max", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lengtheff", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"#", "<", "qmax"}], ",", "#", ",", "True", ",", "qmax"}], 
          "]"}], "&"}], "/@", "length"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxlength", "\[LessEqual]", "qmax"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\\nWarning: \>\"", ",", "Orange", ",", "16", ",", "Bold"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<requested qmax =\>\"", " ", "<>", 
              RowBox[{"ToString", "[", "qmax", "]"}], "<>", 
              "\"\< is larger or equal to the largest nquestions asked = \
\>\"", "<>", 
              RowBox[{"ToString", "[", "maxlength", "]"}], "<>", 
              "\"\< in simulation. No cut has been done.\>\""}], ",", "16", 
             ",", "Bold"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PHASEq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PHASE", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"BELIEF", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"lengtheff", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"indexGetBELIEFq", "[", 
     RowBox[{"qnumber_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"qnumber", "\[LessEqual]", "l"}], ",", "qnumber", ",", "True", 
      ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetBELIEFq", "[", "qmax_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "length", ",", "\[IndentingNewLine]", "stopcondition", ",", 
       "\[IndentingNewLine]", "BELIEFq", ",", "\[IndentingNewLine]", 
       "maxlength"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"(", 
        RowBox[{"Length", "/@", "BELIEF"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxlength", "=", 
       RowBox[{"Max", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stopcondition", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "<", "qmax"}], "&"}], "/@", "length"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxlength", "\[LessEqual]", "qmax"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\\nWarning: \>\"", ",", "Orange", ",", "16", ",", "Bold"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<requested qmax =\>\"", " ", "<>", 
              RowBox[{"ToString", "[", "qmax", "]"}], "<>", 
              "\"\< is larger or equal to the largest nquestions asked = \
\>\"", "<>", 
              RowBox[{"ToString", "[", "maxlength", "]"}], "<>", 
              "\"\< in simulation. No cut has been done.\>\""}], ",", "16", 
             ",", "Bold"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BELIEFq", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BELIEF", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"1", ";;", 
             RowBox[{"indexGetBELIEFq", "[", 
              RowBox[{"qmax", ",", 
               RowBox[{"length", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhasePlotq", "[", 
    RowBox[{"qmax_", ",", "label_", ",", 
     RowBox[{"fname_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nquestionsold", "=", "nquestions"}], ",", "PHASEq", ",", 
       "BELIEFq", ",", "plot"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nquestions", "=", "qmax"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PHASEq", "=", 
       RowBox[{"GetPHASEq", "[", "qmax", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"BELIEFq", "=", 
       RowBox[{"GetBELIEFq", "[", "qmax", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"PhasePlot2", "[", 
        RowBox[{"BELIEFq", ",", "PHASEq", ",", "label"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nquestions", "=", "nquestionsold"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"!", "fname"}], "]"}], ",", "\[IndentingNewLine]", "Nothing",
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{"fname", ",", "plot"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"plot", "=", 
          RowBox[{
           RowBox[{"Import", "[", "fname", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "plot"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"INFO", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"info", "=", "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<dinit = \>\"", "<>", 
        RowBox[{"ToString", "[", "d", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<hinit = \>\"", "<>", 
        RowBox[{"ToString", "[", "h", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<nquestions = \>\"", "<>", 
        RowBox[{"ToString", "[", "nquestions", "]"}], "<>", "\"\<\\n\>\""}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<nexperiments = \>\"", "<>", 
        RowBox[{"ToString", "[", "nexperimentsUSER", "]"}], "<>", 
        "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<npredictors = \>\"", "<>", 
        RowBox[{"ToString", "[", "npredictors", "]"}], "<>", 
        "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<RTHRESHOLD = \>\"", "<>", 
        RowBox[{"ToString", "[", "RTHRESHOLD", "]"}], "<>", "\"\<\\n\>\""}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<R0 = \>\"", "<>", 
        RowBox[{"ToString", "[", "R0", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<B0 = \>\"", "<>", 
        RowBox[{"ToString", "[", "B0", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "INFOPREDICTIVEPOWER"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "info"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SaveSimulation", "[", "id_String", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dir", "=", "id"}], ",", 
      RowBox[{"names", "=", "\"\<\>\""}], ",", "out", ",", 
      RowBox[{"info", "=", "\"\<\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{"saves", " ", "superarrays"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"names", "=", 
       RowBox[{"SUPERARRAYNAME", "//", 
        RowBox[{"DeleteCases", "[", "\"\<PLOTS\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"dir", "<>", "\"\</\>\"", "<>", "#"}], ",", 
            RowBox[{"#", "//", "ToExpression"}], ",", "\"\<String\>\""}], 
           "]"}], "&"}], ")"}], "/@", "names"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "/@", "out"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"saves", " ", "phase", " ", "space", " ", "data"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dir", "<>", "\"\</\>\"", "<>", "\"\<PHASE\>\""}], ",", 
       "PHASE", ",", "\"\<String\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"saves", " ", "BELIEF", "  ", "data"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dir", "<>", "\"\</\>\"", "<>", "\"\<BELIEF\>\""}], ",", 
       "BELIEF", ",", "\"\<String\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"saves", " ", "initital", " ", "d"}], ",", " ", 
       RowBox[{"h", " ", "arrays", " ", "and", " ", "ranges", " ", "aMIN"}], 
       ",", 
       RowBox[{"aMAX", " ", "and", " ", "bMIN"}], ",", "bMAX", ",", " ", 
       RowBox[{
       "and", " ", "other", " ", "values", " ", "for", " ", "the", " ", 
        RowBox[{"simulation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dir", "<>", "\"\</\>\"", "<>", "\"\<info\>\""}], ",", 
       RowBox[{"INFO", "[", "]"}], ",", "\"\<String\>\""}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadSimulation", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"printplot_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dir", "=", "id"}], ",", 
       RowBox[{"names", "=", "\"\<\>\""}], ",", "out", ",", "pts1", ",", 
       "pts2", ",", "label"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"loads", " ", "superarrays"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"names", "=", 
        RowBox[{
         RowBox[{"SUPERARRAYNAME", "//", 
          RowBox[{"DeleteCases", "[", "\"\<PLOTS\>\"", "]"}]}], "//", 
         RowBox[{"DeleteCases", "[", "\"\<EXPERIMENT\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"names", "=", 
        RowBox[{"{", "\"\<CREWARD\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "/@", "names"}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "#", "<>", "\"\<=Import[\\\"\>\"", "<>", "dir", "<>", "\"\</\>\"",
              "<>", "#", "<>", "\"\<\\\"]//ToExpression\>\""}], "//", 
            "ToExpression"}], ")"}], "&"}], "/@", "names"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"loads", " ", "phase", " ", "space", " ", "data"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PHASE", "=", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"dir", "<>", "\"\</PHASE\>\""}], "]"}], "//", 
        "ToExpression"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"loads", " ", "BELIEF", " ", "data"}], ",", " ", 
        RowBox[{"WARNING", ":", " ", 
         RowBox[{
         "overrides", " ", "current", " ", "value", " ", "of", " ", 
          "BELIEF"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "=", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"dir", "<>", "\"\</BELIEF\>\""}], "]"}], "//", 
        "ToExpression"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Protect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "prints", " ", "contents", " ", "of", " ", "info", " ", "file"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"InfoCurrent", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"dir", "<>", "\"\</info\>\""}], "]"}]}], ";", 
      RowBox[{"Print", "[", "InfoCurrent", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"plot", " ", "phase", " ", "diagram"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pts1", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pts2", "=", 
       RowBox[{"BELIEF", "//", "Length"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"printplot", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"label", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pts1", "\[Equal]", "pts2"}], ",", 
            RowBox[{"id", "<>", "\"\<: pts = \>\"", "<>", 
             RowBox[{"ToString", "[", "pts1", "]"}]}], ",", "True", ",", 
            RowBox[{"id", "<>", "\"\<: pts1 = \>\"", "<>", 
             RowBox[{"ToString", "[", "pts1", "]"}], "<>", 
             "\"\<,  pts2 = \>\"", "<>", 
             RowBox[{"ToString", "[", "pts2", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PhasePlot2", "[", 
          RowBox[{"BELIEF", ",", "PHASE", ",", "label"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadSimulationAll", "[", "pattern_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"phasefull", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"belieffull", "=", 
        RowBox[{"{", "}"}]}], ",", "simulationids", ",", "it"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"simulationids", "=", 
       RowBox[{"FileNames", "[", "pattern", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"it", "=", "1"}], ",", 
        RowBox[{"it", "\[LessEqual]", 
         RowBox[{"(", 
          RowBox[{"simulationids", "//", "Length"}], ")"}]}], ",", 
        RowBox[{"it", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<Loading '\>\"", "<>", 
             RowBox[{"simulationids", "[", 
              RowBox[{"[", "it", "]"}], "]"}], "<>", "\"\<'. \>\""}], ",", 
            "Bold", ",", "Blue", ",", "Medium"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"LoadSimulation", "[", 
          RowBox[{
           RowBox[{"simulationids", "[", 
            RowBox[{"[", "it", "]"}], "]"}], ",", "False"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phasefull", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phasefull", ",", 
            RowBox[{"PHASE", "//", "Transpose"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"belieffull", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"belieffull", ",", "BELIEF"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<phasefull size = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"phasefull", "//", "Length"}], "]"}]}], ",", "Bold", 
            ",", "Blue", ",", "Medium"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "[", "BELIEF", "]"}], ";", 
      RowBox[{"BELIEF", "=", "belieffull"}], ";", 
      RowBox[{"Protect", "[", "BELIEF", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PHASE", "=", 
       RowBox[{"phasefull", "//", "Transpose"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulationExists", "[", "id_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "exists", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exists", "=", 
       RowBox[{"DirectoryQ", "[", "id", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exists", "//", "TrueQ"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"warning", ":", " ", 
     RowBox[{
     "deletes", " ", "current", " ", "values", " ", "of", " ", "BELIEF"}]}], 
    ",", " ", "PHASE", ",", " ", 
    RowBox[{"BiasAffPair", " ", "and"}]}], "  ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunSimulation", "[", 
    RowBox[{"id_String", ",", "NSIMULATIONS_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tempplot", ",", "templine", ",", "templine0", ",", "phase", ",", "id2",
        ",", "fullid", ",", "IT", ",", "itregions", ",", "it", ",", "amin", 
       ",", "amax", ",", "bmin", ",", "bmax", ",", "\[IndentingNewLine]", 
       RowBox[{"check1", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"BiasAffPair", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"BeliefFinal", "=", 
        RowBox[{"{", "}"}]}], ",", "a", ",", "b", ",", 
       RowBox[{"AffinityValues", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"BiasValues", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"IT", "=", "1"}], ",", 
        RowBox[{"IT", "\[LessEqual]", "NSIMULATIONS"}], ",", 
        RowBox[{"IT", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"id2", "=", 
          RowBox[{"ToString", "[", "IT", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"fullid", "=", 
          RowBox[{"id", "<>", "\"\<_\>\"", "<>", "id2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"BELIEF", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
         RowBox[{"BELIEF", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BELIEF", "//", "Protect"}], ";", "\[IndentingNewLine]", 
         RowBox[{"PHASE", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BiasAffPair", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"BeliefFinal", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"AffinityValues", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"BiasValues", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SimulationExists", "[", "fullid", "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Simulation '\>\"", "<>", "fullid", "<>", 
             "\"\<' exists. Aborting.\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SaveSimulation", "[", "fullid", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"itregions", "=", "1"}], ",", 
              RowBox[{"itregions", "\[LessEqual]", 
               RowBox[{"(", "nregions", ")"}]}], ",", 
              RowBox[{"itregions", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "sets", " ", "range", " ", "of", " ", "a", " ", "and", " ", 
                "b", " ", "for", " ", "current", " ", "region"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"amin", ",", "amax"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"bmin", ",", "bmax"}], "}"}]}], "}"}], "=", 
                RowBox[{"REGION", "[", 
                 RowBox[{"[", "itregions", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"NotebookDelete", "[", "templine0", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"NotebookDelete", "[", "tempplot", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"templine0", "=", 
                RowBox[{"PrintTemporary", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<region=\>\"", ",", "Large", ",", "Bold"}], 
                   "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"itregions", ",", "Large", ",", "Bold"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"\"\< (out of \>\"", "<>", 
                    RowBox[{"ToString", "[", "nregions", "]"}], "<>", 
                    "\"\<)\>\""}], ",", "Large", ",", "Bold"}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempplot", "=", 
                RowBox[{"PrintTemporary", "[", "phase", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"it", "=", "1"}], ",", 
                 RowBox[{"it", "\[LessEqual]", "ptsREGION"}], ",", 
                 RowBox[{"it", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"to", " ", "show", " ", "progress"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"NotebookDelete", "[", "templine", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"templine", "=", 
                   RowBox[{"PrintTemporary", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<it=\>\"", ",", "Large", ",", "Bold"}], "]"}],
                     ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"it", ",", "Large", ",", "Bold"}], "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "sets", " ", "and", " ", "stores", " ", "values", " ", 
                    "of", " ", "a"}], ",", 
                    RowBox[{
                    "b", " ", "for", " ", "all", " ", "iterations"}]}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"a", "=", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"amin", ",", "amax"}], "}"}], "]"}], ",", 
                    "npredictors"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"b", "=", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"bmin", ",", "bmax"}], "}"}], "]"}], ",", 
                    "npredictors"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"AffinityValues", ",", 
                    RowBox[{"a", "//", "Mean"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"BiasValues", ",", 
                    RowBox[{"b", "//", "Mean"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"initialize", " ", "experiment"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"InitExperimentRewardDriven", "[", 
                   RowBox[{"d", ",", "a", ",", "b", ",", "h"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"run", " ", "experiment"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"RunExperimentStop", "[", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "saves", " ", "data", " ", "on", " ", "degree", " ", "of", 
                    " ", "belief", " ", "during", " ", "the", " ", 
                    "simulation"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"StoreBeliefCurrent", "[", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "store", " ", "values", " ", "for", " ", "phase", " ", 
                    "plot"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"BiasAffPair", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"BiasValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"AffinityValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"AffinityValues", "//", "Length"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"BeliefFinal", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"BELIEF", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"PHASE", "=", 
                   RowBox[{"{", 
                    RowBox[{"BiasAffPair", ",", "BeliefFinal"}], "}"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"phase", "=", 
                   RowBox[{"PhasePlot2", "[", 
                    RowBox[{"BELIEF", ",", "PHASE", ",", 
                    RowBox[{"\"\<j=\>\"", "<>", 
                    RowBox[{"ToString", "[", "it", "]"}]}], ",", "False"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "10"}], "]"}], "\[Equal]", "0"}], "||", 
                    RowBox[{"it", "\[Equal]", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"NotebookDelete", "[", "tempplot", "]"}], ";", 
                    RowBox[{"tempplot", "=", 
                    RowBox[{"PrintTemporary", "[", "phase", "]"}]}]}]}], 
                   "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "30"}], "]"}], "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SaveSimulation", "[", "fullid", "]"}], ",", 
                    "\[IndentingNewLine]", "Nothing", ",", "Nothing"}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"SaveSimulation", "[", "fullid", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", "check1", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"EXPERIMENT", "//", "Flatten"}], "//", 
                RowBox[{"Cases", "[", 
                 RowBox[{"x_", "\[RuleDelayed]", 
                  RowBox[{"x", "/;", 
                   RowBox[{"!", 
                    RowBox[{"NumericQ", "[", "x", "]"}]}]}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
                RowBox[{"check1", ",", "\[IndentingNewLine]", 
                 RowBox[{"List", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<This should print a value of 0: value =  \>\"", ",", 
                    "Large", ",", "Bold", ",", "Black"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"%", "//", "Length"}], "//", "ToString"}], ",", 
                    "Bold", ",", "Large", ",", "Blue"}], "]"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Init", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"SaveSimulation", "[", "fullid", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"check1", "//", "DeleteDuplicates"}], "//", "MatrixForm"}],
           "//", "Print"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Protect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PHASE", "=", 
       RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nquestionsUSER", "=", "1000"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"1000", ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nexperimentsUSER", "=", "600"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"600", ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"npredictorsUSER", "=", "20"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"affinity", " ", "related", " ", "settings"}], ",", " ", 
    RowBox[{"keep", " ", "fixed"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTHRESHOLD", "=", "4.04"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSTABLE", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R0", "=", "50"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"bias", " ", "related", " ", "settings"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B0", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"set", " ", 
      RowBox[{"forecast", ":", " ", "dmax"}]}], "=", "4"}], ",", 
    RowBox[{"nsteps", "=", "8"}], ",", " ", 
    RowBox[{
     RowBox[{"max", " ", "power"}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"21", " ", "\[DoubleLongRightArrow]", " ", "max"}], 
       RowBox[{"{", 
        SubscriptBox["p", "avg"], "}"}]}], " ", "=", " ", "0.9545"}]}], " ", 
    ",", " ", 
    RowBox[{"keep", " ", "fixed"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildPredictivePowerFunction", "[", 
    RowBox[{"4", ",", "8"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "unused", " ", "but", " ", "needed", " ", "for", " ", "function", " ", 
    RowBox[{"below", " ", "'"}], 
    RowBox[{"InitSimulationRewardDriven", "'"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "npredictorsUSER"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "a", " ", "here", " ", "means", " ", "a0", " ", "in", " ", "draft"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "npredictorsUSER"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "initial", " ", "degree", " ", "of", " ", "belief", " ", "and", " ", 
    "random", " ", "walk", " ", "parameter", " ", "h"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4", ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "npredictorsUSER"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 Deletable->False,
 InitializationCell->True,
 CellChangeTimes->{{3.877849809406891*^9, 3.8778498503954067`*^9}, {
   3.8778499309893208`*^9, 3.877849946275546*^9}, {3.8778500049634857`*^9, 
   3.8778501014436083`*^9}, {3.877850249967497*^9, 3.87785025568773*^9}, {
   3.8778502992225227`*^9, 3.877850299386874*^9}, {3.8778530126933937`*^9, 
   3.877853057296454*^9}, {3.877853288457003*^9, 3.877853292054446*^9}, {
   3.8778535412510242`*^9, 3.87785355622231*^9}, {3.877853790115253*^9, 
   3.877853795462759*^9}, {3.8796626040504417`*^9, 3.879662604113306*^9}, {
   3.879662649328985*^9, 3.879662649438696*^9}, {3.8796626810475273`*^9, 
   3.879662681072003*^9}, {3.8796628002387733`*^9, 3.879662800376938*^9}, {
   3.879662877675668*^9, 3.879662877726756*^9}, {3.879665010696828*^9, 
   3.879665010839024*^9}, {3.8796668942293262`*^9, 3.879666894387042*^9}, {
   3.879669761827092*^9, 3.879669761879118*^9}, {3.8796704473795147`*^9, 
   3.879670452825761*^9}, {3.8796704995180283`*^9, 3.879670526584752*^9}, {
   3.879670605986412*^9, 3.879670611863183*^9}, {3.879670659131469*^9, 
   3.879670667975255*^9}, {3.8796707177916193`*^9, 3.879670812096628*^9}, {
   3.8796708791115007`*^9, 3.879670887637148*^9}, {3.8796709237027893`*^9, 
   3.879670970575465*^9}, {3.879671010454867*^9, 3.879671205298746*^9}, {
   3.8798265126625347`*^9, 3.879826512713071*^9}, {3.879832728559978*^9, 
   3.8798327446968803`*^9}, {3.879955576215283*^9, 3.879955577051032*^9}, {
   3.882621112458112*^9, 3.882621112486958*^9}, {3.8826211648175097`*^9, 
   3.8826211649002666`*^9}, {3.882689133863813*^9, 3.88268913457994*^9}, {
   3.882690470948847*^9, 3.8826904719771433`*^9}, {3.8832142751311703`*^9, 
   3.883214279494855*^9}, {3.8832144991296988`*^9, 3.8832145076940413`*^9}, {
   3.883389731796817*^9, 3.883389740559721*^9}, {3.884418990329795*^9, 
   3.884418999067463*^9}, {3.8844190576500187`*^9, 3.884419064162418*^9}, {
   3.884419103328785*^9, 3.884419140506413*^9}, {3.884677253436153*^9, 
   3.884677381587961*^9}, {3.884677435514928*^9, 3.884677572802795*^9}, {
   3.884677625365436*^9, 3.8846776498734913`*^9}, {3.884677945266152*^9, 
   3.884677968764805*^9}, {3.884678005516192*^9, 3.884678034914715*^9}, {
   3.884678856141408*^9, 3.884678977718465*^9}, 3.884679023994988*^9, {
   3.8846790623318863`*^9, 3.884679079931573*^9}, {3.884679184377639*^9, 
   3.884679437006184*^9}, {3.884679477507196*^9, 3.884679770787614*^9}, {
   3.8846802292373857`*^9, 3.884680231134799*^9}, {3.8846945030993233`*^9, 
   3.884694515424842*^9}, {3.884694575811884*^9, 3.884694578864745*^9}, {
   3.8846946142270117`*^9, 3.884694648454653*^9}, {3.8846946868574123`*^9, 
   3.884694728494034*^9}, {3.8846947676683617`*^9, 3.884694823434636*^9}, {
   3.884694859656878*^9, 3.884694899971212*^9}, 3.88476846558851*^9, {
   3.884768545427965*^9, 3.884768546714665*^9}, {3.884768638986491*^9, 
   3.884768651806999*^9}, {3.884769243802144*^9, 3.884769324431933*^9}, {
   3.884774641369945*^9, 3.884774681221307*^9}, {3.8847747418828163`*^9, 
   3.884774979330229*^9}, 3.884775020037456*^9, 3.88477514052313*^9, {
   3.884776060869227*^9, 3.8847764561253366`*^9}, {3.8847772222176*^9, 
   3.884777232571394*^9}, {3.884777724812434*^9, 3.884777853520123*^9}, {
   3.8847780760147533`*^9, 3.884778109467876*^9}, {3.8847783114636383`*^9, 
   3.884778316370758*^9}, {3.884778572231614*^9, 3.884778572600271*^9}, {
   3.88557152800954*^9, 3.8855715282002068`*^9}, {3.885708185619235*^9, 
   3.885708186130542*^9}, {3.885712954602956*^9, 3.88571297816148*^9}, {
   3.8857131189366903`*^9, 3.885713234404542*^9}, {3.885713390347199*^9, 
   3.8857134124652147`*^9}, {3.885713466438541*^9, 3.885713490115161*^9}, {
   3.885713572281404*^9, 3.8857136043994427`*^9}, {3.8857136667296352`*^9, 
   3.8857137010955343`*^9}, {3.885713768478669*^9, 3.885713834497675*^9}, {
   3.885793360249324*^9, 3.8857934409345207`*^9}, {3.885793526750433*^9, 
   3.8857935327163067`*^9}, {3.8857937105169497`*^9, 3.885793735132649*^9}, {
   3.885793848810072*^9, 3.885793853772994*^9}, {3.885820894119595*^9, 
   3.8858208958717527`*^9}, {3.885820945769196*^9, 3.8858209621856213`*^9}, {
   3.885821046066183*^9, 3.885821060285223*^9}, {3.88582109853998*^9, 
   3.885821099082343*^9}, {3.885821188138033*^9, 3.885821190206499*^9}, {
   3.88582126363758*^9, 3.885821302346596*^9}, {3.8860066265248737`*^9, 
   3.8860066265566473`*^9}, {3.886006903829464*^9, 3.886006911196258*^9}, {
   3.886007236236125*^9, 3.886007236289321*^9}, {3.886009701194683*^9, 
   3.886009701228545*^9}, 3.886010918953415*^9, {3.886062144831788*^9, 
   3.886062146225657*^9}, 3.8860732215888433`*^9, {3.8860757677113647`*^9, 
   3.886075814316033*^9}, {3.8860759387131033`*^9, 3.886075939026173*^9}, {
   3.886076524853757*^9, 3.886076524890005*^9}, {3.886076667126721*^9, 
   3.886076723895009*^9}, 3.886243226498722*^9, {3.886243274601191*^9, 
   3.8862432773377132`*^9}, {3.8862433676064777`*^9, 3.886243408105152*^9}, {
   3.886243463521744*^9, 3.886243463870337*^9}, {3.886243603006287*^9, 
   3.886243611276466*^9}, {3.886246761370719*^9, 3.886246767433709*^9}, {
   3.88624852864109*^9, 3.886248529042244*^9}, {3.886248633780814*^9, 
   3.886248647983281*^9}, {3.886248696468925*^9, 3.886248738551869*^9}, {
   3.886248771051456*^9, 3.88624878346176*^9}, {3.886248970814307*^9, 
   3.886248975020073*^9}, {3.886249041672723*^9, 3.886249044119471*^9}, {
   3.8862500851577177`*^9, 3.8862501655536823`*^9}, {3.886250338371626*^9, 
   3.8862503434307013`*^9}, {3.886250508543475*^9, 3.886250532154101*^9}, {
   3.886250689539542*^9, 3.88625073677451*^9}, {3.886250901686037*^9, 
   3.886250902453918*^9}, {3.886251130546434*^9, 3.886251146898573*^9}, {
   3.886251276394189*^9, 3.886251279539764*^9}, {3.8862513945074387`*^9, 
   3.886251399546205*^9}, {3.886251456718154*^9, 3.886251459884605*^9}, {
   3.8862603586288137`*^9, 3.8862603623210278`*^9}, {3.886260952569422*^9, 
   3.886260980286232*^9}, {3.886262099202794*^9, 3.8862620998388767`*^9}, {
   3.886262206916974*^9, 3.8862622075336657`*^9}, {3.886262637433856*^9, 
   3.886262658458515*^9}, {3.886262803636985*^9, 3.886262809221586*^9}, {
   3.886262868064013*^9, 3.886262925949361*^9}, {3.8862630094615793`*^9, 
   3.886263012179512*^9}, {3.8862630568902397`*^9, 3.886263072962137*^9}, {
   3.8862633727921886`*^9, 3.88626338642146*^9}, {3.8862636461294203`*^9, 
   3.8862636508224993`*^9}, {3.886263729895006*^9, 3.886263794427347*^9}, {
   3.886263856746778*^9, 3.88626385681835*^9}, {3.886263931304377*^9, 
   3.8862639343141623`*^9}, {3.886264151359898*^9, 3.886264152083995*^9}, {
   3.886264692950379*^9, 3.886264698590315*^9}, {3.886275912571342*^9, 
   3.886275917577435*^9}, 3.886276059941379*^9, {3.8862761212920322`*^9, 
   3.886276123281177*^9}, {3.886313515528842*^9, 3.8863135274662867`*^9}, {
   3.886313570016099*^9, 3.88631359350664*^9}, {3.886605142824596*^9, 
   3.8866051577837343`*^9}, {3.886605822173861*^9, 3.886606022693726*^9}, {
   3.8866061131657867`*^9, 3.886606117822729*^9}, {3.8866064087667437`*^9, 
   3.886606441682873*^9}, {3.886606683480557*^9, 3.886606746204083*^9}, {
   3.886606800710887*^9, 3.886606801207759*^9}, {3.886606860861372*^9, 
   3.886606865817459*^9}, {3.8866084910823393`*^9, 3.886608505623683*^9}, {
   3.886608570216043*^9, 3.8866086263597183`*^9}, {3.886608798661849*^9, 
   3.886608805136629*^9}, {3.8866089036647453`*^9, 3.886608943319392*^9}, {
   3.8866091117871523`*^9, 3.886609124552534*^9}, {3.886609752958007*^9, 
   3.886609786600758*^9}, {3.886611047760401*^9, 3.886611054108733*^9}, {
   3.88661112431135*^9, 3.886611139983358*^9}, {3.886611570958374*^9, 
   3.8866116086878366`*^9}, {3.8866138908373938`*^9, 
   3.8866138927966843`*^9}, {3.886613928253778*^9, 3.88661393932897*^9}, {
   3.886614198350484*^9, 3.886614201321162*^9}, {3.8866143424919777`*^9, 
   3.886614352258354*^9}, {3.88661503903272*^9, 3.886615039409953*^9}, {
   3.886930008539117*^9, 3.886930015230753*^9}, {3.886930054722825*^9, 
   3.8869300552798347`*^9}, {3.886933748539297*^9, 3.8869337486629343`*^9}, {
   3.8869339932106667`*^9, 3.886934024067276*^9}, {3.886934066017871*^9, 
   3.886934120005575*^9}, {3.886934490121025*^9, 3.886934509738543*^9}, {
   3.886934617238595*^9, 3.88693464793148*^9}, {3.886935220046517*^9, 
   3.88693522102335*^9}, {3.886935349813929*^9, 3.886935390175812*^9}, 
   3.888314335063298*^9, {3.88831455805802*^9, 3.888314569269864*^9}, {
   3.888314668404071*^9, 3.888314671041073*^9}, {3.888314808188882*^9, 
   3.8883148094304543`*^9}, {3.888314951091456*^9, 3.888314953281323*^9}, {
   3.888315528013195*^9, 3.888315529558462*^9}, {3.888506683224476*^9, 
   3.888506683467922*^9}},ExpressionUUID->"c87f32fc-de2d-4417-9182-\
56c21142e143"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.886611711151042*^9, 3.886611775104686*^9}, {
   3.88661190658193*^9, 3.886611938336607*^9}, {3.8866119928709927`*^9, 
   3.886611995992341*^9}, {3.886612100136713*^9, 3.886612100359376*^9}, {
   3.886612165981688*^9, 3.886612166176373*^9}, {3.8866122214959908`*^9, 
   3.886612221664514*^9}, {3.8866122818794413`*^9, 3.8866122846073847`*^9}, {
   3.886612405337597*^9, 3.886612405686945*^9}, {3.886612449984305*^9, 
   3.8866124501191597`*^9}, {3.886612500557535*^9, 3.88661250200294*^9}, {
   3.886612561521092*^9, 3.886612561787121*^9}, {3.8866126099837723`*^9, 
   3.8866126102125273`*^9}, {3.8866126911651173`*^9, 3.88661269156398*^9}, {
   3.886612916925815*^9, 3.886612917227428*^9}, {3.886612969058737*^9, 
   3.8866130588199778`*^9}, {3.886613097392364*^9, 3.886613105701027*^9}, {
   3.8866131393459473`*^9, 3.886613152281432*^9}, {3.8866132057729483`*^9, 
   3.88661322110494*^9}, {3.8866145369816933`*^9, 3.8866145835240498`*^9}, {
   3.886614616343232*^9, 3.886614649142166*^9}, {3.886614725487155*^9, 
   3.886614807294486*^9}, 3.888314345193973*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"939b6cc7-df53-4200-a599-42d4e1ace7ff"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.886613130989005*^9, 3.8866131319582567`*^9}, {
  3.8866131668490133`*^9, 3.886613167097032*^9}, {3.886613293132559*^9, 
  3.886613296854596*^9}, {3.886614824706572*^9, 3.886614832578866*^9}, {
  3.8866150571915703`*^9, 3.8866151232104473`*^9}, {3.886615169584076*^9, 
  3.886615204692809*^9}, {3.886615238894095*^9, 3.886615308708441*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"2ae4144a-53ce-4988-8493-59861a25032f"]
}, Open  ]],

Cell["Run Simulation", "Item",
 CellChangeTimes->{{3.8862642737052383`*^9, 3.8862643521348963`*^9}},
 FontSize->36,ExpressionUUID->"d6185c0f-e759-45cc-925c-bd0b3030943f"],

Cell[CellGroupData[{

Cell[TextData[{
 "Initialize simulation. \[LineSeparator]This sets up the ",
 StyleBox["INITIAL",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " values for d,a,b,h which are all lists of size \
\[OpenCurlyQuote]nquestionsUSER\[CloseCurlyQuote]:\[LineSeparator]- d:  is  \
the degree of belief on the theory (theory is correct by construction)\
\[LineSeparator]- a:  the affinity or tendency for experts to change their \
belief on the theory, motivated by getting higher rewards.\[LineSeparator]- \
b:  is the bias or tendency to reject the objective outcome of experiments, \
based on their own belief of the theory \[LineSeparator]- h:  random walk \
parameter, associated to the  probability  of experts to change their degree \
of belief randomly,\[LineSeparator]          ",
 StyleBox["Probability of Random Walk ",
  FontSlant->"Italic"],
 "= 2h(1-h)",
 "\[LineSeparator]         examples:  h=0.5   \[Rule]  50%   ,  h=0.99   \
\[Rule]  2% ,  h=1.0   \[Rule]  0% (no random walk).\[LineSeparator]The \
simulation performs a number of experiments given by \
\[OpenCurlyQuote]nexperimentsUSER\[CloseCurlyQuote]. Each experiment asks a \
number of questions given by  \[OpenCurlyQuote]nquestionsUSER\
\[CloseCurlyQuote]"
}], "ItemNumbered",
 CellChangeTimes->{{3.877850460084672*^9, 3.877850484491872*^9}, 
   3.8778507074971046`*^9, {3.877851635915229*^9, 3.8778521053165083`*^9}, {
   3.877852194077239*^9, 3.877852219264752*^9}, {3.8778522830096207`*^9, 
   3.877852324575726*^9}},
 FontSize->18,ExpressionUUID->"cd8e440e-a8ee-4820-930f-09a4aec19670"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "set", " ", "ranges", " ", "for", " ", "a0", " ", "and", " ", "b", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"below", ",", " ", 
       RowBox[{"'", 
        RowBox[{"a", "'"}], " ", "refers", " ", 
        RowBox[{"to", " ", "'"}], 
        RowBox[{"a0", "'"}], " ", "in", " ", "draft"}]}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aMIN", "=", "0.0"}], ";", 
    RowBox[{"aMAX", "=", "0.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bMIN", "=", "0.0"}], ";", 
    RowBox[{"bMAX", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "divides", " ", "full", " ", "range", " ", "in", " ", "separate", " ", 
      RowBox[{"regions", ".", " ", "If"}], " ", "a", " ", "diverent", " ", 
      "subdivision", " ", "of", " ", "regions", " ", "is", " ", "wanted"}], 
     ",", " ", 
     RowBox[{"only", " ", "quantities", " ", "marked", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"with", " ", "'"}], "++"}], "++"}], "++"}], "++"}], 
        "++"}], "'"}], " ", "should", " ", "be", " ", 
      RowBox[{"changed", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", "++"}]}]}]}], "*)"}], 
   RowBox[{
    RowBox[{"aINTERVALS", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", "++"}]}]}]}], "*)"}], 
   RowBox[{
    RowBox[{"bINTERVALS", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nregions", "=", 
     RowBox[{"aINTERVALS", " ", "bINTERVALS"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ptsREGION", "=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"nexperimentsUSER", "==", "nregions"}], ",", "1", ",", 
       RowBox[{
        RowBox[{"nexperimentsUSER", "/", "nregions"}], "\[GreaterEqual]", " ",
         "10"}], ",", 
       RowBox[{"Round", "[", 
        RowBox[{"nexperimentsUSER", "/", "nregions"}], "]"}], ",", "True", 
       ",", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{"nexperimentsUSER", "/", "nregions"}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aGRID", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"aMIN", ",", "aMAX", ",", 
       FractionBox[
        RowBox[{"aMAX", "-", "aMIN"}], "aINTERVALS"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bGRID", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"bMIN", ",", "bMAX", ",", 
       FractionBox[
        RowBox[{"bMAX", "-", "bMIN"}], "bINTERVALS"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"REGION", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"aGRID", "[", 
           RowBox[{"[", 
            RowBox[{"i", ";;", 
             RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
          RowBox[{"bGRID", "[", 
           RowBox[{"[", 
            RowBox[{"j", ";;", 
             RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"aGRID", "//", "Length"}], ")"}], "-", "1"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"bGRID", "//", "Length"}], ")"}], "-", "1"}]}], "}"}]}], 
       "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"initializes", " ", "the", " ", "simulation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitSimulationRewardDriven", "[", 
     RowBox[{"d", ",", "a", ",", "b", ",", "h"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.877717455570857*^9, 3.877717472981957*^9}, {
   3.877717529668214*^9, 3.877717579642281*^9}, {3.87771828754522*^9, 
   3.8777183271847553`*^9}, {3.877718568814373*^9, 3.8777185697387114`*^9}, {
   3.8777186447858477`*^9, 3.8777186746096373`*^9}, 3.877718705091196*^9, {
   3.877718831686158*^9, 3.877718832001739*^9}, {3.877718917291276*^9, 
   3.877718920722975*^9}, {3.877718979749209*^9, 3.877718981750771*^9}, {
   3.877719124698331*^9, 3.8777191432329817`*^9}, {3.877719181732769*^9, 
   3.877719183415196*^9}, {3.877719260956642*^9, 3.8777192802574167`*^9}, {
   3.877719408662738*^9, 3.8777194551916227`*^9}, {3.877719706295918*^9, 
   3.87771970765902*^9}, {3.877719769369989*^9, 3.877719770654055*^9}, {
   3.877720199506197*^9, 3.877720263687786*^9}, 3.877720325020751*^9, {
   3.87772037942623*^9, 3.877720403148959*^9}, {3.8777205440000353`*^9, 
   3.87772056137737*^9}, {3.877720805579608*^9, 3.877720864646473*^9}, {
   3.877721151247813*^9, 3.877721211447321*^9}, {3.87772191779492*^9, 
   3.8777219435169992`*^9}, {3.877722096155388*^9, 3.877722111434477*^9}, {
   3.877722153388822*^9, 3.8777221539822083`*^9}, {3.877722195497325*^9, 
   3.877722224355941*^9}, {3.8777223849364*^9, 3.877722398640461*^9}, {
   3.877722448610343*^9, 3.877722449407352*^9}, {3.877722703651243*^9, 
   3.87772270381006*^9}, 3.877722891537698*^9, {3.877722950350548*^9, 
   3.877722995577827*^9}, {3.877723026099086*^9, 3.877723036253376*^9}, {
   3.877723127112804*^9, 3.8777231474312468`*^9}, {3.877723190388356*^9, 
   3.877723224072488*^9}, {3.877723268630764*^9, 3.8777232813095922`*^9}, {
   3.877723314458228*^9, 3.877723341370962*^9}, {3.877723847777141*^9, 
   3.877723850990213*^9}, {3.877724023981489*^9, 3.877724073219266*^9}, {
   3.8777241079319677`*^9, 3.877724120319964*^9}, {3.877724199137141*^9, 
   3.8777242335845623`*^9}, {3.8777242646390657`*^9, 3.877724315317223*^9}, {
   3.877724406407462*^9, 3.877724416484572*^9}, {3.877724611337202*^9, 
   3.8777246258779383`*^9}, {3.877724693138904*^9, 3.877724719162581*^9}, {
   3.8777247754344473`*^9, 3.8777247782195463`*^9}, {3.877724848173815*^9, 
   3.877724871831321*^9}, {3.8777251267758207`*^9, 3.8777252166610413`*^9}, {
   3.8777253477461653`*^9, 3.877725350067518*^9}, {3.877725540391089*^9, 
   3.877725670699461*^9}, {3.877725731976668*^9, 3.8777257326730328`*^9}, {
   3.87772578390167*^9, 3.8777257850226*^9}, {3.877725888148367*^9, 
   3.877725888764739*^9}, {3.877725931331272*^9, 3.877725973173101*^9}, {
   3.877726022052547*^9, 3.87772602208355*^9}, 3.877726095367342*^9, {
   3.8777262139449177`*^9, 3.877726215094809*^9}, {3.877726399284597*^9, 
   3.8777264272899637`*^9}, {3.8777266791400414`*^9, 3.87772679420061*^9}, 
   3.877727018612934*^9, {3.8777271129617023`*^9, 3.877727124449897*^9}, {
   3.877727158722715*^9, 3.877727212802865*^9}, {3.877727405510839*^9, 
   3.877727419971724*^9}, {3.877727601854303*^9, 3.877727601925102*^9}, {
   3.877728636862434*^9, 3.87772863708112*^9}, 3.877729347961465*^9, {
   3.877729744328331*^9, 3.8777297450900507`*^9}, {3.8777297947043133`*^9, 
   3.8777298260007563`*^9}, {3.877730049397681*^9, 3.877730053853709*^9}, {
   3.8777309842373657`*^9, 3.8777309875320377`*^9}, {3.8777310831536083`*^9, 
   3.877731088078211*^9}, {3.877731129410239*^9, 3.877731148137904*^9}, {
   3.877731356068789*^9, 3.877731356940757*^9}, {3.877731388413169*^9, 
   3.8777314061359863`*^9}, {3.877731437263859*^9, 3.877731437543991*^9}, {
   3.877731485461183*^9, 3.877731535581629*^9}, {3.8777315813286858`*^9, 
   3.877731589506621*^9}, 3.877731710450591*^9, {3.8777317845767727`*^9, 
   3.877731832677446*^9}, {3.87773186660012*^9, 3.877731874187121*^9}, {
   3.877732509590454*^9, 3.877732703651251*^9}, {3.877732750251996*^9, 
   3.877732803823634*^9}, {3.8777328750540524`*^9, 3.877732919573757*^9}, {
   3.877732963999651*^9, 3.87773296417689*^9}, {3.877732997710253*^9, 
   3.877733015590835*^9}, {3.87773305210555*^9, 3.877733118048373*^9}, 
   3.877733190681315*^9, {3.8777332565601463`*^9, 3.877733271387616*^9}, {
   3.877733301972392*^9, 3.877733390403523*^9}, {3.8777334536698847`*^9, 
   3.877733587743916*^9}, {3.877733709433773*^9, 3.877733730531983*^9}, {
   3.877733821968644*^9, 3.877733851831646*^9}, {3.877733893630026*^9, 
   3.877733931478611*^9}, {3.87773398143067*^9, 3.8777339825161743`*^9}, {
   3.877734178069571*^9, 3.8777341901402607`*^9}, {3.877734390643858*^9, 
   3.877734417235917*^9}, {3.8777344477699823`*^9, 3.877734474982239*^9}, {
   3.877790085294159*^9, 3.877790134809444*^9}, {3.877791220764236*^9, 
   3.877791242322955*^9}, {3.877791560678125*^9, 3.877791591568481*^9}, {
   3.877791702260969*^9, 3.8777917028406763`*^9}, {3.877791902698707*^9, 
   3.877791909814636*^9}, {3.877792016207567*^9, 3.877792016229987*^9}, {
   3.8777927083911533`*^9, 3.877792712025297*^9}, 3.877793176737914*^9, {
   3.877850832710128*^9, 3.877850840278421*^9}, {3.877852260452052*^9, 
   3.877852267651763*^9}, {3.877853351702199*^9, 3.877853352499977*^9}, {
   3.877853983884467*^9, 3.877853991447155*^9}, {3.8787969944381742`*^9, 
   3.878796995761528*^9}, {3.878797287976742*^9, 3.878797288075398*^9}, {
   3.878797427467231*^9, 3.8787974434215307`*^9}, {3.878797520339224*^9, 
   3.878797542673212*^9}, {3.8787975882414618`*^9, 3.878797588353773*^9}, {
   3.878797643756525*^9, 3.878797674696822*^9}, {3.878797741377206*^9, 
   3.878797749026702*^9}, {3.878797979358535*^9, 3.878797995839057*^9}, {
   3.878798050832161*^9, 3.878798051855632*^9}, {3.8787983021656637`*^9, 
   3.878798364889398*^9}, 3.8787984421954947`*^9, {3.878798521254387*^9, 
   3.878798522659342*^9}, {3.878798648498768*^9, 3.878798648819541*^9}, {
   3.878798708337173*^9, 3.878798708505896*^9}, 3.878798824569779*^9, {
   3.878798920271805*^9, 3.878798920297975*^9}, {3.878799407870047*^9, 
   3.8787994220353413`*^9}, 3.878799590337123*^9, {3.878799766310339*^9, 
   3.8787997664168*^9}, {3.87879990735594*^9, 3.878799907417519*^9}, {
   3.8788000288433723`*^9, 3.878800031525625*^9}, {3.878800155220985*^9, 
   3.8788001553232517`*^9}, {3.878800281779632*^9, 3.878800281916872*^9}, {
   3.878983127329858*^9, 3.878983127429186*^9}, {3.878983324476358*^9, 
   3.878983336832582*^9}, 3.878983443771599*^9, {3.878983508752859*^9, 
   3.878983509829001*^9}, {3.87898355180024*^9, 3.8789835557188177`*^9}, 
   3.8789836509449043`*^9, {3.878984092310343*^9, 3.8789841095742073`*^9}, {
   3.878984185337819*^9, 3.8789841854230537`*^9}, {3.878984219421978*^9, 
   3.878984225488564*^9}, 3.878984544701633*^9, {3.878984613778318*^9, 
   3.878984631376111*^9}, 3.878984931444932*^9, {3.8789850075274477`*^9, 
   3.8789850096588173`*^9}, {3.878985144766548*^9, 3.878985144826356*^9}, {
   3.8795841212030983`*^9, 3.879584124057927*^9}, {3.87958415784908*^9, 
   3.8795841580018187`*^9}, 3.879588205001766*^9, {3.8795882422301064`*^9, 
   3.879588242341058*^9}, {3.879588279162068*^9, 3.879588279203471*^9}, {
   3.879588319482786*^9, 3.879588319711125*^9}, 3.8795895067998466`*^9, {
   3.879589565277039*^9, 3.879589578325006*^9}, {3.879589654953631*^9, 
   3.879589701079274*^9}, {3.8795898170113897`*^9, 3.87958984311062*^9}, {
   3.879593415266471*^9, 3.879593468920074*^9}, {3.879593599237914*^9, 
   3.8795936177200203`*^9}, 3.8795936718315897`*^9, 3.8795937143646107`*^9, 
   3.8795937723213587`*^9, {3.879593872509347*^9, 3.879593872658576*^9}, {
   3.8795992500462723`*^9, 3.879599250393476*^9}, 3.879599309759994*^9, {
   3.8796626202629547`*^9, 3.879662642787407*^9}, 3.879664699225099*^9, {
   3.879664828807951*^9, 3.87966482904311*^9}, {3.879665020271935*^9, 
   3.879665036536807*^9}, {3.879665179804881*^9, 3.8796651798101883`*^9}, {
   3.87966526425278*^9, 3.879665265074819*^9}, {3.8796652958740597`*^9, 
   3.87966531948372*^9}, {3.879665361544029*^9, 3.879665361652367*^9}, {
   3.8796654023820953`*^9, 3.879665455767296*^9}, {3.879665490719287*^9, 
   3.879665520827074*^9}, {3.879665551741961*^9, 3.879665572860055*^9}, {
   3.879665604314064*^9, 3.8796656056277246`*^9}, {3.87966563922818*^9, 
   3.879665645200197*^9}, {3.879665678972095*^9, 3.879665695343431*^9}, 
   3.879665846944729*^9, 3.879666859877584*^9, 3.879666986387599*^9, {
   3.879667095582057*^9, 3.8796670983091087`*^9}, {3.8796671444942417`*^9, 
   3.8796671699545918`*^9}, {3.879667284283513*^9, 3.879667307709934*^9}, {
   3.87966872048997*^9, 3.879668720947918*^9}, {3.879670211221303*^9, 
   3.879670249158717*^9}, {3.879670617562991*^9, 3.879670617623891*^9}, {
   3.879671237459188*^9, 3.8796712377518587`*^9}, {3.879671346357592*^9, 
   3.8796713477336187`*^9}, {3.879671383519685*^9, 3.879671395846746*^9}, {
   3.879674067143752*^9, 3.879674067830991*^9}, {3.8796741723594933`*^9, 
   3.879674172403767*^9}, {3.879674231561661*^9, 3.8796742320235167`*^9}, {
   3.879674556134349*^9, 3.879674575581901*^9}, {3.87967494376719*^9, 
   3.879674943866303*^9}, {3.879675049471983*^9, 3.8796750498217373`*^9}, {
   3.879675127371818*^9, 3.879675150605259*^9}, {3.879676961657662*^9, 
   3.8796769618282948`*^9}, {3.8797087912755003`*^9, 
   3.8797088180308113`*^9}, {3.87970900965352*^9, 3.879709017807955*^9}, {
   3.879710056462885*^9, 3.8797100691778307`*^9}, 3.8797101051170673`*^9, {
   3.8797101365141077`*^9, 3.879710143111157*^9}, {3.8797101884234047`*^9, 
   3.87971018849025*^9}, {3.8797542711578293`*^9, 3.8797542859754467`*^9}, 
   3.879754730426642*^9, 3.879755417466831*^9, {3.879759468741535*^9, 
   3.8797594761761417`*^9}, {3.87975962412225*^9, 3.8797596289479713`*^9}, 
   3.879759853571567*^9, 3.879759957568428*^9, {3.879759998473144*^9, 
   3.879760026646035*^9}, {3.87976006826718*^9, 3.879760068309556*^9}, {
   3.879760101614566*^9, 3.879760105845891*^9}, {3.879761751097394*^9, 
   3.879761753466346*^9}, 3.87976181527314*^9, {3.879761988948505*^9, 
   3.879761992823843*^9}, 3.8797620276440897`*^9, {3.879762324968711*^9, 
   3.8797623457716427`*^9}, 3.8797624731524677`*^9, {3.879762550431004*^9, 
   3.879762568083454*^9}, {3.879762699597146*^9, 3.879762703271221*^9}, {
   3.8798326745421867`*^9, 3.8798326897803926`*^9}, {3.8798328094937143`*^9, 
   3.87983280953721*^9}, {3.879832882107779*^9, 3.8798328934095488`*^9}, {
   3.8798329270226097`*^9, 3.879832945643374*^9}, {3.8798329795351*^9, 
   3.87983301446696*^9}, 3.879833051242079*^9, {3.8798332594740143`*^9, 
   3.879833273695956*^9}, {3.879833347820506*^9, 3.879833348168706*^9}, {
   3.8798333964143057`*^9, 3.879833406233238*^9}, {3.879833471494217*^9, 
   3.879833471629916*^9}, 3.879833510710659*^9, {3.879833547043439*^9, 
   3.879833547329666*^9}, {3.8798337572466097`*^9, 3.879833772086124*^9}, {
   3.879833855745516*^9, 3.879833856463057*^9}, {3.8798339067812*^9, 
   3.8798339069134007`*^9}, {3.87983396375607*^9, 3.8798339643780813`*^9}, {
   3.8798339950274763`*^9, 3.879833995078472*^9}, {3.879834061019949*^9, 
   3.8798340611764393`*^9}, {3.8798341044343443`*^9, 3.879834104585267*^9}, {
   3.879834144144147*^9, 3.879834144205202*^9}, {3.879834220404478*^9, 
   3.879834221097047*^9}, {3.879835006420786*^9, 3.8798350080911303`*^9}, {
   3.8798355798302813`*^9, 3.879835581965239*^9}, {3.879836388780424*^9, 
   3.879836388936413*^9}, {3.879838510468525*^9, 3.8798385106535053`*^9}, {
   3.879840748127831*^9, 3.8798407613145638`*^9}, {3.879840801110783*^9, 
   3.8798408018223143`*^9}, {3.879842848390471*^9, 3.879842848445758*^9}, {
   3.87985374009068*^9, 3.8798537504085617`*^9}, {3.879854686878441*^9, 
   3.879854688437711*^9}, {3.879855301199704*^9, 3.879855301800476*^9}, 
   3.879855355119598*^9, {3.879855807695478*^9, 3.879855808241835*^9}, {
   3.8798571048692017`*^9, 3.879857109226699*^9}, {3.879857156150522*^9, 
   3.879857164490718*^9}, {3.8798572054608994`*^9, 3.879857209047206*^9}, {
   3.879954172439658*^9, 3.87995417249424*^9}, 3.879955435605227*^9, {
   3.8799554799646673`*^9, 3.879955533512637*^9}, {3.879955670010849*^9, 
   3.879955697178687*^9}, {3.879955810445669*^9, 3.8799558385179377`*^9}, {
   3.8799558700939207`*^9, 3.879955870317124*^9}, {3.882608122755129*^9, 
   3.8826081261635*^9}, {3.882611009153738*^9, 3.882611016139826*^9}, {
   3.882614423531399*^9, 3.882614458592717*^9}, 3.882614545708047*^9, {
   3.882614605796444*^9, 3.8826146061325903`*^9}, {3.8826146699184647`*^9, 
   3.882614670014668*^9}, 3.882614767560268*^9, 3.8826148356589212`*^9, 
   3.8826153237230597`*^9, {3.882615371749894*^9, 3.882615371906454*^9}, 
   3.882616687913579*^9, 3.882616962631776*^9, {3.882617870763481*^9, 
   3.8826178729178057`*^9}, {3.8826190965328703`*^9, 
   3.8826190966840267`*^9}, {3.8826191665936623`*^9, 3.882619188559063*^9}, {
   3.882619752987974*^9, 3.8826197531236677`*^9}, {3.8826198428672857`*^9, 
   3.882619850790448*^9}, {3.882619903752767*^9, 3.8826199053618803`*^9}, {
   3.8826200079258347`*^9, 3.882620008005723*^9}, {3.882620452244629*^9, 
   3.882620456479066*^9}, 3.8826206124103203`*^9, {3.882620838687222*^9, 
   3.882620840759317*^9}, 3.882621720766066*^9, {3.882688786468548*^9, 
   3.88268881592023*^9}, {3.882688984941071*^9, 3.882688985134001*^9}, 
   3.8826890883425283`*^9, {3.8826893774688473`*^9, 3.8826893775922747`*^9}, 
   3.882692356376204*^9, {3.882692479503377*^9, 3.882692479658145*^9}, {
   3.882692908481022*^9, 3.882692908560457*^9}, {3.8826931814682198`*^9, 
   3.882693181592888*^9}, {3.882693232289764*^9, 3.8826932326469593`*^9}, 
   3.882693670019256*^9, {3.882694257808527*^9, 3.882694308327476*^9}, {
   3.88269454043641*^9, 3.882694540495803*^9}, {3.8826947018085213`*^9, 
   3.882694705502636*^9}, {3.882694735869748*^9, 3.882694754637184*^9}, {
   3.8826976635096273`*^9, 3.8826976639089203`*^9}, {3.88269829635294*^9, 
   3.882698298855706*^9}, 3.882698517271784*^9, {3.882699231834899*^9, 
   3.8826992333875732`*^9}, {3.882706732220458*^9, 3.8827067324713697`*^9}, {
   3.883210892756555*^9, 3.88321089608784*^9}, {3.883211023754717*^9, 
   3.8832110238446293`*^9}, {3.883211205055324*^9, 3.883211205823962*^9}, {
   3.8832120568029423`*^9, 3.8832120568102293`*^9}, 3.883212938243409*^9, {
   3.883213886136607*^9, 3.883213895493129*^9}, {3.8832141376901197`*^9, 
   3.883214137921136*^9}, {3.8832145939179792`*^9, 3.8832146133148947`*^9}, {
   3.883214868385026*^9, 3.8832148740321417`*^9}, {3.883215101943823*^9, 
   3.8832151021536503`*^9}, {3.883216739733769*^9, 3.88321673979694*^9}, 
   3.8832182895173807`*^9, {3.88321864816565*^9, 3.883218648375873*^9}, {
   3.883218892644969*^9, 3.8832188949382887`*^9}, 3.883219417048237*^9, {
   3.883295977518375*^9, 3.883296002598135*^9}, 3.883296038237063*^9, {
   3.883296864354898*^9, 3.883296890553767*^9}, {3.883296929448691*^9, 
   3.883296938898052*^9}, {3.8832969733194723`*^9, 3.88329697741538*^9}, {
   3.883298181441835*^9, 3.883298184984358*^9}, {3.883298238679543*^9, 
   3.88329823877549*^9}, {3.883298280005397*^9, 3.8832982848314857`*^9}, {
   3.883298337326312*^9, 3.8832983389993362`*^9}, {3.88329837278627*^9, 
   3.8832983728841057`*^9}, {3.88329840565217*^9, 3.883298405934165*^9}, {
   3.8832984501249247`*^9, 3.883298450209681*^9}, {3.883298502054761*^9, 
   3.883298526382079*^9}, {3.8832986280141773`*^9, 3.8832986369861937`*^9}, 
   3.8832987145837917`*^9, {3.883298940228628*^9, 3.883298940428529*^9}, 
   3.883298978188245*^9, {3.883300735388506*^9, 3.883300741442913*^9}, {
   3.88330082163008*^9, 3.88330082172437*^9}, 3.883300905234495*^9, 
   3.883388698238175*^9, {3.883388839043334*^9, 3.88338883920761*^9}, {
   3.883388998782247*^9, 3.8833890240579243`*^9}, {3.883389211474227*^9, 
   3.883389211732265*^9}, {3.883389321372067*^9, 3.883389321481675*^9}, 
   3.883389444712709*^9, {3.883389572742202*^9, 3.883389573574772*^9}, {
   3.8833898957062674`*^9, 3.883389895788745*^9}, 3.883390032176509*^9, {
   3.8833901555319777`*^9, 3.883390156010249*^9}, {3.8833904458421917`*^9, 
   3.883390461234321*^9}, {3.88348373079755*^9, 3.883483922613764*^9}, {
   3.883483962474105*^9, 3.8834840487583237`*^9}, 3.883484169278841*^9, 
   3.883484259163307*^9, {3.8844172720171947`*^9, 3.884417272116961*^9}, {
   3.8844198866806593`*^9, 3.8844198870593243`*^9}, {3.8844214164349327`*^9, 
   3.884421429806819*^9}, {3.884421484958564*^9, 3.884421485656394*^9}, {
   3.884422750510137*^9, 3.8844228004964123`*^9}, {3.884424096488236*^9, 
   3.884424126921815*^9}, {3.884695582062661*^9, 3.884695582345055*^9}, 
   3.884768636579006*^9, {3.884769168054343*^9, 3.88476919470306*^9}, {
   3.884775518338603*^9, 3.884775758640801*^9}, {3.884778462912746*^9, 
   3.8847784742605762`*^9}, 3.88477856794821*^9, {3.884778650302247*^9, 
   3.884778671788357*^9}, {3.88477903634723*^9, 3.884779039510531*^9}, {
   3.88557139199517*^9, 3.885571449497923*^9}, 3.885571497335301*^9, {
   3.885571606409876*^9, 3.885571616908001*^9}, {3.8855727535849*^9, 
   3.8855727547589607`*^9}, {3.885712330679431*^9, 3.8857123404638357`*^9}, {
   3.885712424501552*^9, 3.885712424664885*^9}, {3.885714388947056*^9, 
   3.885714389075489*^9}, {3.885714729583181*^9, 3.885714732269989*^9}, {
   3.88571476765913*^9, 3.8857147996875668`*^9}, {3.885737077424047*^9, 
   3.885737106283257*^9}, {3.885820684988175*^9, 3.8858206875398293`*^9}, {
   3.885833237911951*^9, 3.885833238281404*^9}, {3.8859275623306723`*^9, 
   3.8859276114016047`*^9}, {3.885927730615727*^9, 3.885927730695949*^9}, {
   3.8859792529727077`*^9, 3.8859792545780487`*^9}, {3.886006922884841*^9, 
   3.8860069260544987`*^9}, 3.886009946776626*^9, {3.886011436587702*^9, 
   3.886011436627142*^9}, {3.886062177646047*^9, 3.886062211790793*^9}, {
   3.886076133111072*^9, 3.88607613412271*^9}, {3.886077024013661*^9, 
   3.8860770253293333`*^9}, {3.886243385276335*^9, 3.8862433942385674`*^9}, {
   3.886243453432539*^9, 3.8862434536679296`*^9}, {3.886243571558135*^9, 
   3.8862435717282133`*^9}, 3.886243659522252*^9, {3.886243713159545*^9, 
   3.886243889552652*^9}, {3.886243949041491*^9, 3.886243977418126*^9}, {
   3.886246784031845*^9, 3.8862467857733307`*^9}, 3.886248499211152*^9, {
   3.886249164573882*^9, 3.886249165382869*^9}, {3.886251308228159*^9, 
   3.8862513090831947`*^9}, {3.8862514180194407`*^9, 3.8862514207210484`*^9}},
 
 CellLabel->"In[61]:=",ExpressionUUID->"5084991f-fe4d-4255-ab6e-a18828e83ef9"],

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{3.886264495246727*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"1ee27012-995a-4802-8917-07dfb16e0f93"]
}, Open  ]],

Cell[TextData[{
 "Run simulation. \[LineSeparator]This runs a \[OpenCurlyQuote]for-loop\
\[CloseCurlyQuote], each iteration corresponds to an experiment. Each \
iteration generates new values for ",
 StyleBox["a",
  FontWeight->"Bold"],
 " and ",
 StyleBox["b",
  FontWeight->"Bold"],
 ", and uses the current values for \[LineSeparator]",
 StyleBox["d",
  FontWeight->"Bold"],
 ", updating it according to the affinity, bias and random walk. ",
 StyleBox[" \[LineSeparator]",
  FontWeight->"Bold"],
 "Arrays  \[OpenCurlyQuote]PHASE\[CloseCurlyQuote] and \
\[OpenCurlyQuote]BELIEF\[CloseCurlyQuote]are saved at intermediate steps. \
SUPERARRAYS are not saved at the time.",
 StyleBox["\[LineSeparator]WARNING: Change the \[OpenCurlyDoubleQuote]id\
\[CloseCurlyDoubleQuote] each simulation.   ",
  FontWeight->"Bold"]
}], "ItemNumbered",
 CellChangeTimes->{{3.877850460084672*^9, 3.877850484491872*^9}, 
   3.8778507074971046`*^9, {3.877851635915229*^9, 3.8778521053165083`*^9}, {
   3.877852161791648*^9, 3.877852162159246*^9}, {3.877852238691633*^9, 
   3.877852238894256*^9}, {3.87785234053251*^9, 3.87785237937574*^9}, {
   3.8778524254326267`*^9, 3.877852490737755*^9}, {3.877852574684461*^9, 
   3.877852813907189*^9}, {3.884679885606824*^9, 3.8846799925386457`*^9}, 
   3.884775869306761*^9, 3.885736671378354*^9, {3.886244010818995*^9, 
   3.886244063621626*^9}, {3.8862458660806828`*^9, 3.886245942035348*^9}, {
   3.886245991147397*^9, 3.886245991781198*^9}, {3.8862460417170773`*^9, 
   3.886246042401271*^9}, {3.886246117667039*^9, 3.886246129676001*^9}, {
   3.8862501978574047`*^9, 3.8862501980040483`*^9}},
 FontSize->18,ExpressionUUID->"cf88db25-2259-4947-9dff-e3b82b027f65"],

Cell[CellGroupData[{

Cell["\<\

Decide how many simulations should be run with NSIMULATIONS. 
Change \[OpenCurlyQuote]id\[CloseCurlyQuote] for a new run. \
\>", "Subsection",
 CellChangeTimes->{{3.885736799469211*^9, 3.885736852915313*^9}, {
  3.886246176389353*^9, 3.886246212855768*^9}, {3.886264436559114*^9, 
  3.886264450560255*^9}, {3.886264927812763*^9, 3.886264929106793*^9}},
 FontSize->24,ExpressionUUID->"bec88f3e-017f-43bc-b259-3795f9f2ce9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NSIMULATIONS", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", "=", "\"\<1\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunSimulation", "[", 
  RowBox[{
   RowBox[{"\"\<case_II2_h-0_\>\"", "<>", "id"}], ",", "NSIMULATIONS"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.886246797456933*^9, 3.8862468090807*^9}, {
   3.886264112826934*^9, 3.8862641270404863`*^9}, 3.886264799023827*^9, {
   3.886264829769494*^9, 3.886264863740697*^9}, {3.886264915878305*^9, 
   3.8862649238115892`*^9}, 3.886615981987599*^9, 3.8883143751380777`*^9, {
   3.8883148260193043`*^9, 3.8883148261089087`*^9}, {3.888506690764357*^9, 
   3.888506691528226*^9}},ExpressionUUID->"76c6d82a-7091-4827-8e94-\
f8f3cee0a91d"],

Cell[CellGroupData[{

Cell["Load Simulation and export plots", "Item",
 CellChangeTimes->{{3.8862642737052383`*^9, 3.8862643521348963`*^9}, {
  3.8866159970010357`*^9, 3.886616003949585*^9}},
 FontSize->36,ExpressionUUID->"70c7eb1f-f1bf-4b2c-8c63-94286b70d059"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"LoadSimulationAll", "[", "\"\<case_II2_1_*\>\"", "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8866160305295143`*^9, 3.8866160718596992`*^9}, 
   3.886929836220607*^9, 3.886936180175288*^9, 3.888314384688566*^9, {
   3.888314831420676*^9, 3.888314831464806*^9}, 
   3.888506699604047*^9},ExpressionUUID->"c20e146b-7516-4bc6-be5d-\
b6da55f1fb09"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"qmax", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "50", ",", "100", ",", "1000"}], "}"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"case", " ", "II", " ", "draft"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"it", "=", "1"}], ",", 
      RowBox[{"it", "\[LessEqual]", 
       RowBox[{"(", 
        RowBox[{"qmax", "//", "Length"}], ")"}]}], ",", 
      RowBox[{"it", "++"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"qmax", "[", 
            RowBox[{"[", "it", "]"}], "]"}], "\[Equal]", "1000"}], ",", 
          RowBox[{"\"\<j=\!\(\*SubscriptBox[\(n\), \(max\)]\)=\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"qmax", "[", 
             RowBox[{"[", "it", "]"}], "]"}], "]"}]}], ",", "True", ",", 
          RowBox[{"\"\<j=\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"qmax", "[", 
             RowBox[{"[", "it", "]"}], "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PhasePlotq", "[", 
        RowBox[{
         RowBox[{"qmax", "[", 
          RowBox[{"[", "it", "]"}], "]"}], ",", "label", ",", 
         RowBox[{"\"\<plot_case_II2_j-\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"qmax", "[", 
            RowBox[{"[", "it", "]"}], "]"}], "]"}], "<>", "\"\<.pdf\>\""}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.88660565559552*^9, 3.886605656449131*^9}, 
   3.886608432141811*^9, 3.886615355786963*^9, {3.886615391407652*^9, 
   3.886615427374579*^9}, 3.886616125770392*^9, {3.8869300914938583`*^9, 
   3.886930100551093*^9}, {3.886930217310237*^9, 3.88693034924561*^9}, {
   3.8869307631176643`*^9, 3.886930765160832*^9}, {3.886930805153211*^9, 
   3.8869308116937513`*^9}, {3.886931007527081*^9, 3.886931009232955*^9}, {
   3.886931051810381*^9, 3.8869310679323883`*^9}, {3.886931320569632*^9, 
   3.886931328408813*^9}, 3.886936053628048*^9, {3.886936249972814*^9, 
   3.886936268716918*^9}, {3.888314404205813*^9, 3.88831441211703*^9}, {
   3.888314897586947*^9, 3.888314904574313*^9}, 
   3.888506701800981*^9},ExpressionUUID->"86ee8c36-db31-4d62-b10f-\
ceacc27104f7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1239, 664},
WindowMargins->{{20, Automatic}, {1, Automatic}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bb82231e-71ff-475a-b493-4f77ca302b0c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 2, 59, "Item",ExpressionUUID->"3d534153-7ecd-45e7-b627-6e865fe32bc6"],
Cell[790, 26, 77176, 1733, 7672, "Input",ExpressionUUID->"c87f32fc-de2d-4417-9182-56c21142e143",
 InitializationCell->True],
Cell[77969, 1761, 1191, 16, 30, "Input",ExpressionUUID->"939b6cc7-df53-4200-a599-42d4e1ace7ff"],
Cell[79163, 1779, 467, 6, 30, "Input",ExpressionUUID->"2ae4144a-53ce-4988-8493-59861a25032f"]
}, Open  ]],
Cell[79645, 1788, 170, 2, 59, "Item",ExpressionUUID->"d6185c0f-e759-45cc-925c-bd0b3030943f"],
Cell[CellGroupData[{
Cell[79840, 1794, 1559, 28, 251, "ItemNumbered",ExpressionUUID->"cd8e440e-a8ee-4820-930f-09a4aec19670"],
Cell[81402, 1824, 22323, 368, 448, "Input",ExpressionUUID->"5084991f-fe4d-4255-ab6e-a18828e83ef9"],
Cell[103728, 2194, 164, 2, 30, "Input",ExpressionUUID->"1ee27012-995a-4802-8917-07dfb16e0f93"]
}, Open  ]],
Cell[103907, 2199, 1690, 33, 131, "ItemNumbered",ExpressionUUID->"cf88db25-2259-4947-9dff-e3b82b027f65"],
Cell[CellGroupData[{
Cell[105622, 2236, 433, 8, 123, "Subsection",ExpressionUUID->"bec88f3e-017f-43bc-b259-3795f9f2ce9f"],
Cell[106058, 2246, 754, 15, 73, "Input",ExpressionUUID->"76c6d82a-7091-4827-8e94-f8f3cee0a91d"],
Cell[CellGroupData[{
Cell[106837, 2265, 239, 3, 59, "Item",ExpressionUUID->"70c7eb1f-f1bf-4b2c-8c63-94286b70d059"],
Cell[107079, 2270, 409, 9, 30, "Input",ExpressionUUID->"c20e146b-7516-4bc6-be5d-b6da55f1fb09"],
Cell[107491, 2281, 2399, 52, 136, "Input",ExpressionUUID->"86ee8c36-db31-4d62-b10f-ceacc27104f7"]
}, Open  ]]
}, Open  ]]
}
]
*)

